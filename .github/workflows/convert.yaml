name: Convert to Text and HTML

on:
  push

jobs:
  to-text:
    name: Convert to Text
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
      # - name: Prepare Output Directories
      #   run: |
      #     for d in baselines/*/; do
      #       echo $d
      #       mkdir -p pandoc/$d
      #     done
      - name: Convert
        uses: docker://pandoc/core:3.5
        with:
          entrypoint: /bin/sh
          args: -c "find baselines -iname '*.md' -type f -exec sh -c 'baselines ${0} --from markdown --to plain -o baselines/${0%.md}.txt' {} \;"
      - uses: actions/upload-artifact@v4
        with:
          name: html
          path: baselines
  to-html:
    name: Convert to HTML
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
      - name: Install converter
        run: npm i markdown-to-html-cli -g
      - name: Convert
        run: markdown-to-html --source baselines/aad.md --output baselines/aad.html
      - name: Upload
        uses: actions/upload-artifact@v4
          with:
          name: text
          path: baselines
