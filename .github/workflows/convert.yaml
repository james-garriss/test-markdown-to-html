name: Convert to Text and HTML

on:
  push

jobs:
  to-text:
    name: Convert to Text
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
      # - name: Prepare Output Directories
      #   run: |
      #     for d in baselines/*/; do
      #       echo $d
      #       mkdir -p pandoc/$d
      #     done
      - name: convert md to docx
        uses: docker://pandoc/core:3.5
        with:
          entrypoint: /bin/sh
          args: -c "find baselines -iname '*.md' -type f -exec sh -c 'pandoc ${0} --from markdown --to plain -o pandoc/${0%.md}.txt' {} \;"
      - uses: actions/upload-artifact@v4
        with:
          name: output
          path: pandoc
  to-html:
    name: Convert to HTML
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
      - run: npm i markdown-to-html-cli -g
      - run: markdown-to-html --source baselines/aad.md --output love/aad.html
      - uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: Changed files
