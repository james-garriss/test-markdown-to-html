name: Convert to Text and HTML

on:
  push

jobs:
  convert:
    name: Convert
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
      - name: Convert AAD to Text
        uses: docker://pandoc/core:3.5
        with:
          args: --standalone --output=baselines/aad.html baselines/aad.md
      - name: Convert Defender to Text
        uses: docker://pandoc/core:3.5
        with:
          args: --standalone --output=baselines/defender.html baselines/defender.md
      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: text
          path: baselines
      - name: Install HTML converter
        run: npm i markdown-to-html-cli -g
      - name: Convert to HTML
        run: |
          markdown-to-html --source baselines/aad.md --output baselines/aad.html
          markdown-to-html --source baselines/defender.md --output baselines/defender.html
      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: html
          path: baselines
